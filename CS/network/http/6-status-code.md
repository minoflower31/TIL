# HTTP 상태코드

**상태코드**란, 클라이언트가 보낸 요청에 대한 처리 상태를 응답에서 알려주는 코드
+ **1xx** (Infomational): 요청이 수신되어 처리중인 상태
+ **2xx** (Successful): 요청 정상 처리
+ **3xx** (Redirection): 요청을 완료하려면 유저 에이전트의 추가 조치가 필요
+ **4xx** (Client Error)
+ **5xx** (Server Error)

## 2xx (Successful)

### 200 OK

요청 처리에 대한 성공

### 201 Created

요청 처리에 성공해서 새로운 리소스가 생성됨 (e.g. 회원가입)

HTTP 응답 메시지 가운데, `Location`라는 헤더에 리소스를 담음
+ Location: /members/1

### 202 Accepted

요청이 접수됐으나 처리되지 않은 상태. **배치 처리** 같은 곳에서 사용한다. (잘 사용 X)

### 204 No Content

요청 처리를 성공했지만 응답 페이로드 본문에 보낼 데이터가 없을 때 사용. 웹 문서의 save 기능의 결과로 아무런 내용이 없어도 되고, 현재 화면을 유지해야 한다.
+ 협의 과정을 통해서 정하는 것이 좋음(200,201 코드만 사용할까요?)

<br>

## 3xx (Redirection)

**리다이렉션**은 웹 브라우저가 받은 3xx 응답에 Location 헤더가 있으면, Location 헤더에 담긴 위치로 자동 이동

리다이렉션은 3가지가 존재하는데
+ **영구 리다이렉션**: 특정 리소스의 URI에 영구적으로 이동 (e.g. /members -> users)
+ **일시 리다이렉션**: 일시적인 변경 (e.g. 주문이 완료되면 주문 내역 화면으로 이동)
  + **PRG(Post/Redirect/Get)** 이라고도 한다.
+ **특수 리다이렉션**: 캐시 사용

### 영구적인 리다이렉션 (301, 308)

기존 URI를 사용하지 않으며, 검색엔진 같은 곳에서는 변경을 인지한다.
+ **301 Moved Permanently**
  + 리다이렉트 시 요청 메서드는 `GET`으로 변한다. 단, 메시지 바디가 제거될 수 있다.
  + 브라우저에 구현된 스펙에서는 `GET`을 사용하기 때문에 `POST`로 전송해도 `GET`으로 바꾼다.
  + 메시지 바디가 사라지면 `GET`으로 페이지를 다시 보여준 후, 새로운 등록폼에 다시 작성해야 함.
+ **308 Permanent Redirect**
  + 301과 같이 영구적으로 이동하지만 요청 메서드와 메시지 바디는 유지한다. (`POST`로 전송해도 `POST` 유지) 
  + 실무에서는 잘 사용하지 않는데, 내부적으로 전달해야 하는 내용 자체가 바뀔 가능성이 크기 때문에 기본 입력을 유지하는 것은 별로 의미가 없다.

### 일시적인 리다이렉션 (302, 307, 303)

검색엔진 같은 곳에서는 URI를 변경하면 큰일! (일시적으로 이동하기 때문)

+ `302 Found` -> 이것만 써도 문제없음
  + 리다이렉트 시 요청 메서드가 GET으로 변한다. 단, 메시지 바디가 제거될 수 있다.
+ **307 Temporary Redirect**
  + 302와 같이 일시적으로 이동하지만, 요청 메서드와 메시지 바디는 유지한다.
+ **303 See Other**
  + 302와 같지만, 요청 메서드가 GET으로 변경한다.


#### 일시적인 리다이렉션을 주로 사용하는 이유?

1. **주문 화면**에서 `POST`로 주문을 완료하고 나서 **새로고침**하면, **주문 완료 화면**에서 **주문 화면**으로 돌아와 다시 POST로 요청한다.
   + 원칙적으로는 이미 주문한 상품임을 서버에서 인지해 방지해야 한다.
2. 1번의 상황을 방지하기 위해 **PRG** 도입.
   + 주문 완료 화면으로 이동될 때 이 주문 완료 화면을 `GET`으로 리다이렉트 시행
   + 이제는 새로고침을 해도 `GET`으로 요청하게 됨.


### 특수적인 리다이렉션 (300,304)

+ **304 Not Modified**
  + 캐시를 목적으로 사용하고, 클라이언트에게 리소스가 수정되지 않았음을 알려주는 코드 (음,, 이 자원은 너가 가지고 있는거야 너 pc에서 저장된 캐시로 사용해)
  + 당연히 캐시를 사용해야 하므로 응답에 메시지 바디를 포함해서는 안된다.

<br>

## 4xx (Client Error)

클라이언트는 잘못된 요청을 반복해서 보내도 실패함.

### 400 Bad Request

클라이언트의 잘못된 요청으로 서버는 요청 처리할 수 없음을 의미. (잘못된 요청 파라미터, API 스펙에 맞지 않는 데이터 유형)

### 401 Unauthorized

클라이언트가 해당 리소스에 대한 **인증**이 필요한 상태.
+ `WWW-Authenticate` 헤더로 인증 방법을 명시
+ 인증(Authentication): 로그인 시 (인증이 더 큰 개념)
+ 인가(Authorization): 권한에 따른 것

### 403 Forbidden
서버가 요청을 받았지만 승인을 거부한 상태 (인증은 했으나 권한이 없을 경우)

### 404 Not Found
요청 리소스를 찾을 수 없을 때 (권한이 없거나, 해당 리소스를 숨기고 싶을 때)

### 405 Method Not Allowed
브라우저가 요청한 메서드가 서버에서는 지원하지 않을 때 

<br>

## 5xx (Server Error)

예외 케이스를 잘 작성해야 함

### 500 Internal Server Error

서버 문제로 오류가 발생함. (대부분 사용됨)
+ e.g. NullPointerException, DB 오류

### 503 Service Unavailable

서버가 **일시적인 과부하**가 생기거나 **예정된 작업**으로 잠시 요청을 처리할 수 없을 때
+ `Retry-After` 헤더로 복구 시기를 보낼 수 있음.

<br>
<br>

> 출처: 인프런 - 김영한님의 모든 개발자를 위한 HTTP 웹 기본 지식 https://inf.run/g8eP